<ng-container *ngIf="!isLoading; else loading">
  <section fxLayout="row" fxLayout.xs="column" fxLayoutAlign="center">
    <div fxLayout="column" fxFlex.gt-xs="25" fxLayoutAlign="center">
      <div fxFlex="grow" fxLayoutAlign="center center" class="border bg-white _cursor-pointer _img-container" (click)="filePicker.click()">
        <img class="w-100" [src]="imagePreview" [alt]="form.value.title" *ngIf="imagePreview && !isCompressing">
        <mat-hint *ngIf="isCompressing">Uploading...</mat-hint>
        <mat-icon [inline]="true" class="text-muted"  *ngIf="!imagePreview">add_photo_alternate</mat-icon>
      </div>
      <button [@fadeAnimation]="'in'" mat-stroked-button type="button" (click)="filePicker.click()" class="rounded-0 border-top-0"
        *ngIf="!imagePreview">Pick Image</button>
        <button mat-stroked-button color="warn" type="button" (click)="onDeleteImage()" class="rounded-0 border-top-0"
        *ngIf="imagePreview">Delete Image</button>
      <input type="file" accept="image/*" class="invisible position-absolute" (change)="onImagePicked($event)" #filePicker>
    </div>
    <mat-card fxFlex="grow" fxFlex.gt-xs="50" fxFlexOffset="2">
      <!-- <form (submit)="onSavePost(postForm)" #postForm="ngForm" fxLayout="column"> -->
      <form [formGroup]="form" (submit)="onSavePost()" fxLayout="column">
        <mat-form-field>
          <!-- <input matInput placeholder="Title" type="text" name="title" [ngModel]="post?.title" #title="ngModel" required> -->
          <input matInput placeholder="Title" type="text" formControlName="title">
          <mat-error *ngIf="form.get('title').invalid">Required</mat-error>
        </mat-form-field>
        <mat-form-field>
          <!-- <textarea matInput cdkTextareaAutosize placeholder="Content" name="content" [ngModel]="post?.content" #content="ngModel" required></textarea> -->
          <textarea matInput cdkTextareaAutosize placeholder="Content" formControlName="content"></textarea>
          <mat-error *ngIf="form.get('content').invalid">Required</mat-error>
        </mat-form-field>
        <div fxLayout fxLayoutAlign="space-between center">
          <div fxLayout>
            <mat-error [@fadeAnimation]="formErrorState">{{formErrorMessage}}</mat-error>
            <mat-hint [@fadeAnimation]="formHintState">{{formHintMessage}}</mat-hint>
          </div>
          <div>
            <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid || isCompressing">Save Post</button>
            <button mat-raised-button color="warn" type="button" (click)="onDelete()" *ngIf="modeTypes.edit === mode" class="ml-2"><mat-icon>delete</mat-icon></button>
          </div>
        </div>
      </form>
    </mat-card>
  </section>
</ng-container>

<ng-template #loading>
  <div fxLayout fxLayoutAlign="center">
    <mat-spinner></mat-spinner>
  </div>
</ng-template>
